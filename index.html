// AuthorCraft Appreciation Expansion

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fox & Owl Story Studio — AuthorCraft Appreciation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --plum: #340c44;
      --gold: #bd9b40;
      --text-light: #f7efe3;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: var(--plum);
      color: var(--text-light);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      position: relative;
      overflow: hidden;
    }

    /* Background overlay — only for game modes */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.9;
      pointer-events: none;
      z-index: 0;
    }

    body.mode-film::before { background-image: url("Theater overlay.png"); }
    body.mode-literature::before { background-image: url("Library overlay.png"); }
    body.landing::before { background-image: none; }

    .app-root {
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 1200px;
      padding: 24px;
      box-sizing: border-box;
      display: flex;
      justify-content: center;
    }

    .hidden { display: none !important; }

    /* -------- Landing screen -------- */
    .landing-screen {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 24px;
    }

    .landing-logo {
      max-width: 520px;
      width: 80%;
      height: auto;
      display: block;
    }

    .play-button {
      margin-top: 16px;
      padding: 10px 32px;
      border-radius: 999px;
      border: 2px solid var(--gold);
      background: transparent;
      color: var(--gold);
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: transform 0.1s ease-out, box-shadow 0.1s ease-out, background 0.1s ease-out;
    }

    .play-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.65);
      background: rgba(0, 0, 0, 0.18);
    }

    /* -------- Game screen -------- */
    .game-screen {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    /* Keep original toggle style & position */
    .mode-toggle-wrapper {
      position: absolute;
      top: 26px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 2;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .mode-toggle {
      display: inline-flex;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 999px;
      padding: 3px;
      border: 1px solid rgba(0, 0, 0, 0.9);
    }

    .mode-btn {
      border: none;
      padding: 6px 22px;
      border-radius: 999px;
      font-size: 0.85rem;
      cursor: pointer;
      background: transparent;
      color: #d0ced4;
      transition: background 0.15s ease, color 0.15s ease;
    }

    .mode-btn.active {
      background: #101010;
      color: var(--gold);
    }

    /* New: small top actions, styled to match */
    .top-actions {
      display: inline-flex;
      gap: 10px;
      align-items: center;
      margin-left: 10px;
    }

    .top-action-btn {
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: rgba(0, 0, 0, 0.7);
      color: var(--gold);
      padding: 6px 16px;
      border-radius: 999px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out, background 0.08s ease-out;
      white-space: nowrap;
    }

    .top-action-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.55);
      background: rgba(0, 0, 0, 0.78);
    }

    .game-area {
      width: 100%;
      max-width: 900px;
      margin: 110px auto 40px;
      padding: 24px 26px 28px;
      box-sizing: border-box;
      border-radius: 18px;
      background: radial-gradient(circle at top, rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.85));
      border: 1px solid rgba(189, 155, 64, 0.9);
      box-shadow:
        0 0 0 1px rgba(0, 0, 0, 0.5),
        0 24px 50px rgba(0, 0, 0, 0.85);
    }

    .header-row {
      display: flex;
      justify-content: space-between;
      gap: 16px;
      align-items: baseline;
      margin-bottom: 16px;
    }

    .scene-title {
      font-size: 1.1rem;
      color: var(--gold);
    }

    .tier-label {
      font-size: 0.95rem;
      color: var(--gold);
    }

    .scene-text {
      font-size: 0.98rem;
      line-height: 1.5;
      margin-bottom: 16px;
      color: var(--text-light);
    }

    /* This replaces "question-text" with mode prompt text */
    .mode-prompt {
      font-size: 1.05rem;
      font-weight: 500;
      margin: 6px 0 12px;
      color: var(--gold);
    }

    .meta-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
    }

    .gate-icons {
      font-size: 1.1rem;
      display: flex;
      gap: 4px;
      cursor: pointer;
    }

    .gate-icon {
      filter: drop-shadow(0 0 4px rgba(0,0,0,0.9));
    }

    /* Tooltip / key */
    .gate-tooltip {
      position: absolute;
      right: 24px;
      top: 70px;
      max-width: 280px;
      padding: 10px 12px;
      border-radius: 10px;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(189, 155, 64, 0.9);
      color: var(--text-light);
      font-size: 0.78rem;
      line-height: 1.35;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.8);
      z-index: 5;
    }

    .gate-tooltip .gate-key-title {
      font-weight: 600;
      margin-bottom: 6px;
      color: var(--gold);
    }

    .gate-tooltip .gate-key-row {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      margin-bottom: 2px;
    }

    .gate-tooltip .gate-key-icon { width: 1.1rem; }

    /* -------- New: mode tabs (matches existing pill style) -------- */
    .mode-tabs {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      justify-content: flex-start;
      margin: 4px 0 10px;
      flex-wrap: wrap;
    }

    .mode-tab {
      text-align: center;
      border-radius: 999px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: #050505;
      color: #d0ced4;
      padding: 7px 14px;
      font-size: 0.88rem;
      cursor: pointer;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out,
        border-color 0.08s ease-out, background 0.08s ease-out;
      user-select: none;
    }

    .mode-tab:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.65);
      border-color: var(--gold);
      background: #111111;
      color: var(--text-light);
    }

    .mode-tab.active {
      border-color: var(--gold);
      color: var(--gold);
    }

    /* -------- Mode views container -------- */
    .mode-view { display: none; margin-top: 10px; }
    .mode-view.active { display: block; }

    /* Keep visuals simple for now; JS will populate */
    .placeholder {
      border-radius: 14px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: rgba(0,0,0,0.55);
      padding: 14px 16px;
      color: #d0ced4;
      font-size: 0.92rem;
      line-height: 1.4;
    }

    /* Notes (minimal, inside same card to preserve rhythm) */
    .notes-wrap {
      margin-top: 14px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .notes-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .notes-title {
      color: var(--gold);
      font-weight: 600;
    }

    .notes-btn {
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: #050505;
      color: var(--gold);
      padding: 6px 14px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .notes-area {
      width: 100%;
      min-height: 120px;
      resize: vertical;
      border-radius: 14px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: rgba(0,0,0,0.65);
      color: var(--text-light);
      padding: 10px 12px;
      font-size: 0.95rem;
      line-height: 1.35;
      box-sizing: border-box;
    }

    .notes-tip {
      color: #d0ced4;
      font-size: 0.82rem;
    }

    @media (max-width: 900px) {
      .game-area {
        margin-top: 90px;
        padding: 18px 16px 22px;
      }
      .mode-toggle-wrapper {
        top: 18px;
        flex-wrap: wrap;
        justify-content: center;
      }
    }
  </style>
</head>

<body class="landing">
  <div class="app-root">
    <!-- Landing Screen -->
    <section id="landing-screen" class="landing-screen">
      <img
        src="Fox and Owl Story Studio Logo.png"
        alt="The Fox & Owl Story Studio"
        class="landing-logo"
      />
      <button id="play-btn" class="play-button">Play!</button>
    </section>

    <!-- Game Screen -->
    <section id="game-screen" class="game-screen hidden">
      <div class="mode-toggle-wrapper">
        <div class="mode-toggle">
          <button id="mode-film" class="mode-btn" data-mode="film">Film</button>
          <button id="mode-literature" class="mode-btn active" data-mode="literature">Literature</button>
        </div>

        <div class="top-actions">
          <button id="btn-new-scene" class="top-action-btn" type="button">New scene</button>
          <button id="btn-reset" class="top-action-btn" type="button">Reset</button>
        </div>
      </div>

      <div id="game-area" class="game-area">
        <div class="header-row">
          <div id="scene-title" class="scene-title">Scene –</div>
          <div class="meta-right">
            <div id="gate-icons" class="gate-icons" title="Attractors"></div>
            <div id="tier-label" class="tier-label"></div>
          </div>
        </div>

        <div id="scene-text" class="scene-text"></div>

        <!-- Mode tabs -->
        <div class="mode-tabs" role="tablist" aria-label="AuthorCraft modes">
          <button id="tab-pair" class="mode-tab active" type="button" role="tab" aria-selected="true">Pair Match</button>
          <button id="tab-sliders" class="mode-tab" type="button" role="tab" aria-selected="false">Sliders</button>
          <button id="tab-buckets" class="mode-tab" type="button" role="tab" aria-selected="false">Buckets</button>
          <button id="tab-spotlights" class="mode-tab" type="button" role="tab" aria-selected="false">Spotlights</button>
        </div>

        <!-- Mode prompt (replaces old question text) -->
        <div id="mode-prompt" class="mode-prompt">
          Set your read using descriptive axes. Sliders are neutral—no “better” direction.
        </div>

        <!-- Views (JS will populate these; no scoring/correctness DOM) -->
        <div id="view-pair" class="mode-view active" aria-label="Pair Match view">
          <div class="placeholder">
            Pair Match container (JS renders left cards + right cards + placements). No correctness UI.
          </div>
        </div>

        <div id="view-sliders" class="mode-view" aria-label="Sliders view">
          <div class="placeholder">
            Sliders container (JS renders axes + range inputs). Neutral defaults.
          </div>
        </div>

        <div id="view-buckets" class="mode-view" aria-label="Buckets view">
          <div class="placeholder">
            Buckets container (JS renders Engine/Support/Spice + draggable items).
          </div>
        </div>

        <div id="view-spotlights" class="mode-view" aria-label="Spotlights view">
          <div class="placeholder">
            Spotlights container (JS renders multiple interpretive takes; optional user take).
          </div>
        </div>

        <!-- Notes (kept inside the same card to preserve “feel”) -->
        <div class="notes-wrap">
          <div class="notes-row">
            <div class="notes-title">Notes</div>
            <button id="btn-copy-notes" class="notes-btn" type="button">Copy</button>
          </div>
          <textarea id="notes-area" class="notes-area" placeholder="Write what you noticed..."></textarea>
          <div class="notes-tip">Tip: jot evidence (“what”) + mechanism (“why”) + effect (“so what”).</div>
        </div>

        <!-- Tooltip for attractor key (kept, repurpose from gates) -->
        <div id="gate-tooltip" class="gate-tooltip hidden"></div>
      </div>
    </section>
  </div>

  <!-- Keep your existing runtime file name for now -->
  <script src="questions.js"></script>

  <!-- Minimal tab switching (safe; no quiz logic) -->
  <script>
    (function() {
      const tabs = [
        { id: "tab-pair", view: "view-pair", prompt: "Match micro-moments to why they land. No scoring—make the strongest read you can defend." },
        { id: "tab-sliders", view: "view-sliders", prompt: "Set your read using descriptive axes. Sliders are neutral—no “better” direction." },
        { id: "tab-buckets", view: "view-buckets", prompt: "Sort craft elements into Engine / Support / Spice. You’re arguing what matters most." },
        { id: "tab-spotlights", view: "view-spotlights", prompt: "Select spotlights that can coexist. Multiple readings can be valid at the same time." }
      ];

      const promptEl = document.getElementById("mode-prompt");

          // ------------------------------------------------------------------
    // Landing -> Game transition + default medium
    // ------------------------------------------------------------------
    const landingScreen = document.getElementById("landing-screen");
    const gameScreen = document.getElementById("game-screen");
    const playBtn = document.getElementById("play-btn");

    const filmBtn = document.getElementById("mode-film");
    const litBtn = document.getElementById("mode-literature");

    function setMedium(medium) {
      // Update button active state
      const isFilm = medium === "film";
      filmBtn?.classList.toggle("active", isFilm);
      litBtn?.classList.toggle("active", !isFilm);

      // Update body class to swap background overlay
      document.body.classList.remove("mode-film", "mode-literature", "landing");
      document.body.classList.add(isFilm ? "mode-film" : "mode-literature");

      // Notify runtime (questions.js / main.js) to load correct packs
      document.dispatchEvent(new CustomEvent("sourcechange", { detail: { source: medium } }));
    }

    function enterGame(defaultMedium = "film") {
      // Show game, hide landing
      landingScreen?.classList.add("hidden");
      gameScreen?.classList.remove("hidden");

      // Ensure body background overlay activates
      setMedium(defaultMedium);

      // Optional: start on a deterministic mode tab
      setActive("tab-pair");

      // Ask runtime to load first scene
      document.dispatchEvent(new CustomEvent("scenenext"));
    }

    // Wire Play button
    playBtn?.addEventListener("click", () => enterGame("film"));

    // Wire medium toggle buttons (Film / Literature)
    filmBtn?.addEventListener("click", () => setMedium("film"));
    litBtn?.addEventListener("click", () => setMedium("literature"));


      function setActive(tabId) {
        tabs.forEach(t => {
          const tab = document.getElementById(t.id);
          const view = document.getElementById(t.view);
          const active = t.id === tabId;
          if (tab) {
            tab.classList.toggle("active", active);
            tab.setAttribute("aria-selected", active ? "true" : "false");
          }
          if (view) view.classList.toggle("active", active);
          if (active && promptEl) promptEl.textContent = t.prompt;
        });

        document.dispatchEvent(new CustomEvent("modechange", { detail: { tabId } }));
      }

      tabs.forEach(t => {
        const tab = document.getElementById(t.id);
        if (tab) tab.addEventListener("click", () => setActive(t.id));
      });

      document.getElementById("btn-new-scene")?.addEventListener("click", () => {
        document.dispatchEvent(new CustomEvent("scenenext"));
      });

      document.getElementById("btn-reset")?.addEventListener("click", () => {
        document.dispatchEvent(new CustomEvent("modereset"));
      });

      document.getElementById("btn-copy-notes")?.addEventListener("click", async () => {
        const txt = document.getElementById("notes-area")?.value || "";
        try { await navigator.clipboard.writeText(txt); } catch(e) {}
      });
    })();
  </script>
</body>
</html>
