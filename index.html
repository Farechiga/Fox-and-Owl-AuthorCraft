<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fox & Owl Story Studio — AuthorCraft Appreciation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --plum: #340c44;
      --gold: #bd9b40;
      --text: #f7efe3;
      --muted: #d0ced4;
      --black: #050505;
    }

    html, body { height: 100%; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: var(--plum);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      position: relative;
      overflow: hidden;
    }

    /* Background overlay — only used for game modes */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.9;
      pointer-events: none;
      z-index: 0;
    }
    body.mode-film::before { background-image: url("Theater overlay.png"); }
    body.mode-literature::before { background-image: url("Library overlay.png"); }
    body.landing::before { background-image: none; }

    .app-root {
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 1200px;
      padding: 24px;
      box-sizing: border-box;
      display: flex;
      justify-content: center;
    }
    .hidden { display: none !important; }

    /* -------- Landing screen -------- */
    .landing-screen {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 24px;
    }
    .landing-logo {
      max-width: 520px;
      width: 80%;
      height: auto;
      display: block;
    }
    .play-button {
      margin-top: 16px;
      padding: 10px 32px;
      border-radius: 999px;
      border: 2px solid var(--gold);
      background: transparent;
      color: var(--gold);
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: transform 0.1s ease-out, box-shadow 0.1s ease-out, background 0.1s ease-out;
    }
    .play-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.65);
      background: rgba(0, 0, 0, 0.18);
    }

    /* -------- Game screen -------- */
    .game-screen {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    /* Toggle centered at top, like original */
    .mode-toggle-wrapper {
      position: absolute;
      top: 26px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 2;
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
    }

    .mode-toggle {
      display: inline-flex;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 999px;
      padding: 3px;
      border: 1px solid rgba(0, 0, 0, 0.9);
    }

    .mode-btn {
      border: none;
      padding: 6px 22px;
      border-radius: 999px;
      font-size: 0.85rem;
      cursor: pointer;
      background: transparent;
      color: var(--muted);
      transition: background 0.15s ease, color 0.15s ease;
    }
    .mode-btn.active {
      background: #101010;
      color: var(--gold);
    }

    .game-area {
      width: 100%;
      max-width: 900px;
      margin: 110px auto 40px;
      padding: 24px 26px 28px;
      box-sizing: border-box;
      border-radius: 18px;
      background: radial-gradient(circle at top, rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.85));
      border: 1px solid rgba(189, 155, 64, 0.9);
      box-shadow:
        0 0 0 1px rgba(0, 0, 0, 0.5),
        0 24px 50px rgba(0, 0, 0, 0.85);
    }

    .header-row {
      display: flex;
      justify-content: space-between;
      gap: 16px;
      align-items: baseline;
      margin-bottom: 16px;
    }
    .scene-title {
      font-size: 1.1rem;
      color: var(--gold);
    }
    .scene-text {
      font-size: 0.98rem;
      line-height: 1.5;
      margin-bottom: 12px;
      color: var(--text);
    }

    .meta-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
    }
    .tier-label {
      font-size: 0.95rem;
      color: var(--gold);
    }
    .gate-icons {
      font-size: 1.1rem;
      display: flex;
      gap: 4px;
      cursor: default;
      user-select: none;
    }
    .gate-icon {
      filter: drop-shadow(0 0 4px rgba(0,0,0,0.9));
    }

    /* Mode tabs: same pill language */
    .mode-tabs {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      justify-content: flex-start;
      margin: 8px 0 12px;
      flex-wrap: wrap;
    }
    .mode-tab {
      text-align: center;
      border-radius: 999px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: var(--black);
      color: var(--muted);
      padding: 7px 14px;
      font-size: 0.88rem;
      cursor: pointer;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out,
        border-color 0.08s ease-out, background 0.08s ease-out;
      user-select: none;
    }
    .mode-tab:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.65);
      border-color: var(--gold);
      background: #111111;
      color: var(--text);
    }
    .mode-tab.active {
      border-color: var(--gold);
      color: var(--gold);
    }

    /* Mode prompt (short, non-dev) */
    .mode-prompt {
      font-size: 1.05rem;
      font-weight: 500;
      margin: 6px 0 12px;
      color: var(--gold);
    }

    /* Views */
    .mode-view { display: none; margin-top: 6px; }
    .mode-view.active { display: block; }

    /* Sub-panels inside views should match the “black pill / black panel” vibe */
    .panel {
      border-radius: 14px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: rgba(0,0,0,0.55);
      padding: 14px 16px;
    }

    /* Pair Match layout */
    .pair-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 760px) {
      .pair-grid { grid-template-columns: 1fr; }
      .game-area { margin-top: 90px; padding: 18px 16px 22px; }
      .mode-toggle-wrapper { top: 18px; }
    }
    .pair-col-title {
      color: var(--gold);
      font-weight: 600;
      margin-bottom: 10px;
      font-size: 0.95rem;
    }
    .list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .chip {
      border-radius: 999px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: #0b0b0b;
      color: var(--text);
      padding: 10px 14px;
      font-size: 0.95rem;
      line-height: 1.25;
    }

    /* Sliders */
    .slider-row {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
      margin-bottom: 12px;
    }
    .slider-axis {
      color: var(--text);
      font-size: 0.95rem;
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    input[type="range"] { width: 100%; accent-color: var(--gold); }

    /* Buckets */
    .bucket-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 900px) { .bucket-grid { grid-template-columns: 1fr; } }
    .bucket-title {
      color: var(--gold);
      font-weight: 600;
      margin-bottom: 10px;
      font-size: 0.95rem;
    }
    .bucket-drop {
      min-height: 120px;
      border-radius: 14px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: rgba(0,0,0,0.4);
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* Spotlights */
    .spotlight {
      border-radius: 14px;
      border: 1px solid rgba(0, 0, 0, 0.9);
      background: rgba(0,0,0,0.55);
      padding: 12px 14px;
      margin-bottom: 10px;
      color: var(--text);
      font-size: 0.95rem;
      line-height: 1.35;
      cursor: pointer;
    }
    .spotlight.selected {
      outline: 2px solid rgba(189, 155, 64, 0.9);
      outline-offset: 2px;
    }
  </style>
</head>

<body class="landing">
  <div class="app-root">

    <!-- Landing Screen -->
    <section id="landing-screen" class="landing-screen">
      <img
        src="Fox and Owl Story Studio Logo.png"
        alt="The Fox & Owl Story Studio"
        class="landing-logo"
      />
      <button id="play-btn" class="play-button">Play!</button>
    </section>

    <!-- Game Screen -->
    <section id="game-screen" class="game-screen hidden">
      <div class="mode-toggle-wrapper" aria-label="Medium toggle">
        <div class="mode-toggle">
          <button id="mode-film" class="mode-btn active" data-mode="film" type="button">Film</button>
          <button id="mode-literature" class="mode-btn" data-mode="literature" type="button">Literature</button>
        </div>
      </div>

      <div id="game-area" class="game-area">
        <div class="header-row">
          <div id="scene-title" class="scene-title">Scene —</div>
          <div class="meta-right">
            <div id="gate-icons" class="gate-icons" aria-label="Attractors"></div>
            <div id="tier-label" class="tier-label"></div>
          </div>
        </div>

        <div id="scene-text" class="scene-text"></div>

        <div class="mode-tabs" role="tablist" aria-label="AuthorCraft modes">
          <button id="tab-pair" class="mode-tab active" type="button" role="tab" aria-selected="true">Pair Match</button>
          <button id="tab-sliders" class="mode-tab" type="button" role="tab" aria-selected="false">Sliders</button>
          <button id="tab-buckets" class="mode-tab" type="button" role="tab" aria-selected="false">Buckets</button>
          <button id="tab-spotlights" class="mode-tab" type="button" role="tab" aria-selected="false">Spotlights</button>
        </div>

        <div id="mode-prompt" class="mode-prompt"></div>

        <!-- Pair Match -->
        <div id="view-pair" class="mode-view active" aria-label="Pair Match view">
          <div class="pair-grid">
            <div class="panel">
              <div class="pair-col-title">Micro-moments</div>
              <div id="pair-left" class="list"></div>
            </div>
            <div class="panel">
              <div class="pair-col-title">Why they land</div>
              <div id="pair-right" class="list"></div>
            </div>
          </div>
        </div>

        <!-- Sliders -->
        <div id="view-sliders" class="mode-view" aria-label="Sliders view">
          <div class="panel">
            <div id="sliders-container"></div>
          </div>
        </div>

        <!-- Buckets -->
        <div id="view-buckets" class="mode-view" aria-label="Buckets view">
          <div class="panel" style="margin-bottom:12px;">
            <div class="pair-col-title">Elements</div>
            <div id="bucket-elements" class="list"></div>
          </div>

          <div class="bucket-grid">
            <div class="panel">
              <div class="bucket-title">Engine</div>
              <div id="bucket-engine" class="bucket-drop"></div>
            </div>
            <div class="panel">
              <div class="bucket-title">Support</div>
              <div id="bucket-support" class="bucket-drop"></div>
            </div>
            <div class="panel">
              <div class="bucket-title">Spice</div>
              <div id="bucket-spice" class="bucket-drop"></div>
            </div>
          </div>
        </div>

        <!-- Spotlights -->
        <div id="view-spotlights" class="mode-view" aria-label="Spotlights view">
          <div id="spotlights-container"></div>
        </div>

      </div>
    </section>
  </div>

  <!-- Keep your existing runtime filename for now. Updated to module script type -->
  <script type="module" src="./CraftAppreciation.js"></script>

  <script>
    (function () {
      const landingScreen = document.getElementById("landing-screen");
      const gameScreen = document.getElementById("game-screen");
      const playBtn = document.getElementById("play-btn");

      const filmBtn = document.getElementById("mode-film");
      const litBtn  = document.getElementById("mode-literature");

      const promptEl = document.getElementById("mode-prompt");

      const tabDefs = [
        { id: "tab-pair", view: "view-pair", key: "pairMatch",
          prompt: "Match micro-moments to why they land. Make the strongest read you can defend." },
        { id: "tab-sliders", view: "view-sliders", key: "sliders",
          prompt: "Set your read using descriptive axes." },
        { id: "tab-buckets", view: "view-buckets", key: "rankBuckets",
          prompt: "Sort the craft elements by what drives the scene." },
        { id: "tab-spotlights", view: "view-spotlights", key: "interpretiveTakes",
          prompt: "Choose the spotlights that can coexist." }
      ];

      function setMedium(medium) {
        const isFilm = medium === "film";
        filmBtn.classList.toggle("active", isFilm);
        litBtn.classList.toggle("active", !isFilm);

        document.body.classList.remove("landing", "mode-film", "mode-literature");
        document.body.classList.add(isFilm ? "mode-film" : "mode-literature");

        document.dispatchEvent(new CustomEvent("sourcechange", { detail: { source: medium } }));
      }

      function setTab(tabId) {
        for (const t of tabDefs) {
          const tab = document.getElementById(t.id);
          const view = document.getElementById(t.view);
          const active = t.id === tabId;
          tab.classList.toggle("active", active);
          tab.setAttribute("aria-selected", active ? "true" : "false");
          view.classList.toggle("active", active);
          if (active && promptEl) promptEl.textContent = t.prompt;

          if (active) {
            document.dispatchEvent(new CustomEvent("modechange", { detail: { modeKey: t.key } }));
          }
        }
      }

      function enterGame() {
        landingScreen.classList.add("hidden");
        gameScreen.classList.remove("hidden");

        // Default medium: Film (you requested default; no extra buttons)
        setMedium("film");

        // Default mode tab
        setTab("tab-pair");

        // Ask runtime to load a scene (your renderer will listen)
        document.dispatchEvent(new CustomEvent("scenenext"));
      }

      playBtn.addEventListener("click", enterGame);

      filmBtn.addEventListener("click", () => setMedium("film"));
      litBtn.addEventListener("click", () => setMedium("literature"));

      for (const t of tabDefs) {
        document.getElementById(t.id).addEventListener("click", () => setTab(t.id));
      }

      // When your renderer decides the user has completed the current mode,
      // it should dispatch: document.dispatchEvent(new CustomEvent("advance"));
      // This index file does not implement correctness/advancing logic, which lives in the JS file.
    })();
  </script>
</body>
</html>
